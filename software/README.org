#+TITLE: y-arena software
#+AUTHOR: Peter Polidoro
#+EMAIL: peterpolidoro@gmail.com

* Repository Information
  - Name :: y-arena software
  - Author :: Peter Polidoro
  - Email :: peterpolidoro@gmail.com

** Description

   Documentation and files for the Y Arena software.

* Update Containers

  #+BEGIN_SRC sh
    cd ~/y-arena
    git pull origin master
    git submodule update --recursive
    cd software/y_arena_valve_controller_ros
    docker system prune -f
    docker build -t y_arena_valve_controller:latest .
  #+END_SRC

*** Development

    #+BEGIN_SRC sh
      docker system prune -f
      docker create -it --name devel ros:dashing bash
      docker start -i devel
      mkdir -p /ws/src/y_arena_valve_controller
      exit
      docker cp . devel:/ws/src/y_arena_valve_controller
      docker start -i devel
      source /opt/ros/dashing/setup.bash
      cd /ws
      colcon build
    #+END_SRC

    #+BEGIN_SRC sh
      docker run -v /dev/arena:/dev/arena -it --restart unless-stopped\
             --device=/dev/ttyACM0 \
             --device=/dev/ttyACM1 \
             --device=/dev/ttyACM2 \
             --device=/dev/ttyACM3 \
             --device=/dev/ttyACM4 \
             --device=/dev/ttyACM5 \
             --device=/dev/ttyACM6 \
             --device=/dev/ttyACM7 \
             --device=/dev/ttyACM8 \
             --device=/dev/ttyACM9 \
             --device=/dev/ttyACM10 \
             --device=/dev/ttyACM11 \
             --device=/dev/ttyACM12 \
             --device=/dev/ttyACM13 \
             --device=/dev/ttyACM14 \
             --device=/dev/ttyACM15 \
             y_arena_valve_controller_ros_ycontroller \
             ros2 launch y_arena_valve_controller controller.launch.py
    #+END_SRC

    #+BEGIN_SRC sh
      ros2 topic pub --once /arena_valves_on y_arena_interfaces/msg/ArenaValves "{arena: 0, valves: [0, 1, 2]}"
    #+END_SRC
